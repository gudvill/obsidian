SQL (Structured Query Language) - это язык запросов для управления реляционными базами данных. 
**«Реляционные»** означает, что все данные хранятся в виде взаимосвязанных таблиц. SQL нужен для того, чтобы как-то влиять на элементы внутри этих таблиц: добавлять, удалять, изменять и т. д.
### Виды запросов в SQL

![[sql-запросы.png]]

Всего их четыре - **DDL, DML, DCL, TCL** (они выполняют определённые действия):
1. **DDL (data definition language)** - определение данных, настройка базы данных (создание с нуля и прописывание её структуры).
	Примеры: **CREATE**, **DROP**, **RENAME**, **ALTER**;
2. **DML (data manipulation language)** - управление данными в таблицах (добавление, обновление, удаление и выбор данных).
	Примеры: **SELECT**, **UPDATE**, **DELETE**, **INSERT**;
3. **DCL (data control language)** - выдача или отзыв права доступа для пользователей.
	Примеры: **GRANT**, **REVOKE**, **DENY**;
4. **TCL (transaction control language)** - управление транзакциями; запросы, связанные с подтверждением или откатом изменений в базе данных.
	Примеры: **COMMIT**, **ROLLBACK**, **BEGIN**.
### Операторы SQL-запроса

- **SELECT** - выбирает отдельные столбцы или таблицу целиком, чтобы потом передать данные другим запросам на обработку;
- **FROM** - ставится после SELECT, указывает, из какой таблицы (имя таблицы) или источника данных приходит информация;
- **AS** - задаёт название для новой колонки;
- **WHERE** - условие фильтрации, которому должны удовлетворять строки, чтобы они попали в результат выполнения запроса (в условии используются логические конструкции AND, OR и BETWEEN);
- **GROUP** **BY** - группировка данных по определённым столбцам. В результате получается новая таблица, составленная на основе выбранных данных. Может использовать также агрегатные функции, чтобы производить вычисления с данными в таблице:
	- COUNT - посчитать количество строк;
	- SUM - посчитать сумму значений в столбце;
	- AVG - получить среднее значение в столбце;
	- MIN - получить минимальное значение в столбце;
	- MAX - получить максимальное значение в столбце.
- **HAVING** - условие, по которому сгруппированные данные будут отфильтрованы (похож на WHERE по функциональности);
- **ORDER** **BY** - столбец, по которому полученные строки будут отсортированы по возрастанию или убыванию (ASC и DESC);
- **LIMIT** - позволяет ограничить количество строк в финальной выдаче;
- **UPDATE** - позволяет изменить данные в таблице;
- **DELETE** - удаляет строку;
- **DROP COLUMN** - удаляет столбец;
- **DROP TABLE** - удаляет таблицу;

### Оператор JOIN

**JOIN** - оператор, который объединяет данные из двух разных таблиц в базе. Цель использования команды - получить нужное подмножество данных.
Обычно JOIN используется в блоках SELECT, которые выбирают из базы таблицы и записи, отвечающие нужным критериям.
#### Для чего нужен оператор JOIN
- для фильтрации сведений по определенным критериям;
- для быстрого отсечения информации, которая не нужна в рамках конкретного запроса;
- для соединения двух таблиц в одну, например, для отправки полученной информации единым блоком.
#### Как работает JOIN
Оператору передаются таблицы, которые нужно объединить, и критерий для объединения - логическое выражение, которое называется ключом. В процессе работы JOIN таблицы проверяются на соответствие этому критерию. Например, значение поля ID в одной таблице должно соответствовать полю ID в другом. Оператор проверит строки обеих таблиц и выберет пары строк, где ID совпадают. 

Найденные результаты объединяются в одну таблицу. Две соответствующие друг другу разные строки преобразуются в одну. Строки чаще всего из разных таблиц, но это не обязательно. Главная особенность JOIN - объединение двух объектов в один.
#### Варианты работы JOIN
Чаще всего выделяют четыре режима SQL JOIN: Inner, Outer, Self и Cross.
1. **Inner Join** - внутреннее объединение, бинарное «И» (дефолтный). Возвращает внутреннее пересечение двух таблиц по какому-либо критерию. Результатом будут записи, которые соответствуют обеим таблицам;
![[inner join.png]]

2. **Outer Join** - внешнее соединение, несколько вариаций бинарного «ИЛИ». Возвращает не только строгое пересечение между двумя таблицами, но и отдельные элементы, которые принадлежат только одному из множеств. Типы:
- **Left Join** - возвращает пересечение множеств и все элементы из левой таблицы;
![[left join.png]]

- **Right Join** - возвращает пересечение множеств и все элементы из правой таблицы;
![[right join.png]]

- **Join Full** - возвращает обе таблицы, объединенные в одну;
![[join full.png]]

- **Outer Join с NULL** - это тот же самый Outer Join, но с дополнительным параметром, который убирает из результатов поиска пересечение категорий. Это противоположность Inner Join;
- **Left Join с NULL** - возвращает данные из левой таблицы, но без пересечений с правой;
![[left join с null.png]]

- **Right Join с NULL** - возвращает данные из правой таблицы, но без пересечений с левой;
![[right join с null.png]]

- **Join Full с NULL** - работает как исключающее «или». Возвращает результат из обеих таблиц, кроме пересечений. Результаты перед отправкой объединяются в одну таблицу;
![[join full с null.png]]

3. **Cross Join** - ещё называется перекрестным. Он возвращает декартово произведение - собираются все возможные пары из обеих таблиц. В отличие от остальных режимов, Cross Join не требует указания дополнительной информации. Стандартное обращение к двум таблицам тоже покажет декартово произведение. Cross Join отличается от простого вызова двух таблиц тем, что они объединяются в одну.

	В виде диаграммы Венна это соединение представить невозможно. Скорее можно объяснить его на примере математики. Например, в одном наборе десять чисел, в другом — пять. Cross Join между этими наборами — это все возможные комбинации сумм двух чисел из разных наборов. Результат будет выглядеть как таблица 11×5, где в каждой ячейке лежит своя сумма.
![[cross join.png]]

4. **Self Join** - это «самосоединение», объединение внутри одной таблицы. Оно используется тогда, когда у разных полей одной таблицы могут быть одинаковые значения. Эта вариация может быть и внутренней, и внешней. Ее отличие в том, что таблица при таком режиме присоединяется сама к себе. Без практики это может быть непривычно, но в процессе использования логику работы легко понять. Чтобы Self Join работал правильно, могут потребоваться псевдонимы таблиц: они помогают называть одну и ту же таблицу разными именами. В результате оператор «воспринимает» переданные сущности как разные.